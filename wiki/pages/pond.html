{% extends "layout.html" %}

{% block title %}Home{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='pond.css') }}">
{% endblock %}

{% block page_content %}

<div id="interactive-pond-demo">
  <div id="renderContainer"></div>
  <div class="panel" id="controls">
    <h2>Interactive Pond - Working Demo</h2>
    <p>Rotate the scene. Hover to highlight regions. Click to show info.</p>
    <div class="row">
      <label for="timescale">Timeline</label>
      <input id="timescale" type="range" min="0" max="1" step="0.01" value="0" />
    </div>
    <div class="row" style="margin-top: 8px">
      <button id="resetBtn" class="btn">Reset View</button>
      <div style="flex: 1"></div>
      <button id="createBacteria" class="btn">Create Bacteria</button>
    </div>
    <p style="margin-top: 10px; font-size: 12px; color: var(--muted)">Click parts to read about nitrate leaching and algal blooms.</p>
  </div>
  <div id="infoBox" aria-live="polite"></div>
  <div class="legend" aria-hidden="false">
    <div class="item">
      <span class="sw" style="background: #4fc3f7"></span>Water
    </div>
    <div class="item">
      <span class="sw" style="background: #85532d"></span>Soil
    </div>
    <div class="item">
      <span class="sw" style="background: #6fcf97"></span>Algae
    </div>
    <div class="item">
      <span class="sw">
        <img class="legend-icon" src="https://static.igem.wiki/teams/6006/gallery/wetlab/pond/bacteria.avif" alt="Bacteria">
      </span>Bacteria
    </div>
    <div class="item">
      <span class="sw">
        <img class="legend-icon" src="https://static.igem.wiki/teams/6006/gallery/wetlab/pond/ammonium.avif" alt="Ammonium Ion">
      </span>Ammonium
    </div>
    <div class="item">
      <span class="sw">
        <img class="legend-icon" src="https://static.igem.wiki/teams/6006/gallery/wetlab/pond/nitrate.avif" alt="Nitrate Ion">
      </span>Nitrate
    </div>
  </div>
</div>

<div class="narrative-box-info">
  <p>
    This interactive model represents a pond environment under stress. Initially, you can observe how nitrates continuously leach into the water, causing eutrophication that leads to massive algal blooms and the death of fish populations, simply <strong>drag the timeline</strong> to see this progression.
  </p>
  <p>
    To intervene, click <strong>"Reset View"</strong> then <strong>"Create Bacteria."</strong> This deploys our engineered <em>Pseudomonas putida</em>, which activates the <strong>DNRA pathway</strong>. By converting leachable nitrates into stable ammonium, the bacteria ensure nitrogen binds to the soil instead of polluting the water, restoring ecosystem health and aiding plant growth.
  </p>
</div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='three/three.min.js') }}" defer></script>
<script src="{{ url_for('static', filename='three/addons/OrbitControls.js') }}" defer></script>
<script src="{{ url_for('static', filename='three/addons/SimplexNoise.js') }}" defer></script>
<script src="{{ url_for('static', filename='pond.js') }}" defer></script>
{% endblock %}
